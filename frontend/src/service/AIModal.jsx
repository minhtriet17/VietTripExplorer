import { GoogleGenerativeAI } from "@google/generative-ai";

const apiKey = import.meta.env.VITE_GOOGLE_GEMINI_AI_API_KEY;
const genAI = new GoogleGenerativeAI(apiKey)

const model = genAI.getGenerativeModel({
    model: "gemini-2.0-flash",
})

const generationConfig = {
    temperature: 1,
    topP: 0.9,
    maxOutputTokens: 8192,
    responseMimeType: "application/json",
}

    export const chatSession = model.startChat({
        generationConfig,
        history: [
            {
                role:"user",
                parts: [
                    {
                        text: `Tạo kế hoạch du lịch cho địa điểm: Hà Nội, trong 2 ngày cho các cặp đôi có ngân sách hạn hẹp, cung cấp cho tôi danh sách các lựa chọn khách sạn với HotelName, Địa chỉ khách sạn, Giá, URL hình ảnh khách sạn, tọa độ địa lý, xếp hạng, mô tả và đề xuất hành trình với PlaceName, Chi tiết địa điểm, URL hình ảnh địa điểm, Tọa độ địa lý, Giá vé, xếp hạng, Du hành thời gian của từng địa điểm trong 3 ngày với kế hoạch cho từng ngày cùng thời điểm tốt nhất để ghé thăm theo định dạng JSON.`,
                    }
                ]
            },
            {
                role: "model",
                parts: [
                        {text: "```json\n{\n  \"tripDetails\": {\n    \"destination\": \"Hà Nội\",\n    \"duration\": \"2 ngày\",\n    \"targetAudience\": \"Các cặp đôi\",\n    \"budget\": \"Hạn hẹp\",\n    \"bestTimeToVisit\": \"Mùa thu (Tháng 9 - Tháng 11) hoặc Mùa xuân (Tháng 3 - Tháng 4) khi thời tiết ôn hòa, khô ráo, ít mưa, rất lý tưởng để đi bộ khám phá.\"\n  },\n  \"hotelOptions\": [\n    {\n      \"HotelName\": \"Hanoi Old Quarter Hotel\",\n      \"Address\": \"39 Hàng Hòm, Hàng Gai, Hoàn Kiếm, Hà Nội\",\n      \"Price\": \"Khoảng 500.000 - 800.000 VND/đêm\",\n      \"ImageUrl\": \"https://pix8.agoda.net/hotelImages/488/488673/488673_14061614070019971489.jpg?ce=0&s=1024x\",\n      \"Coordinates\": {\n        \"latitude\": 21.0315,\n        \"longitude\": 105.8495\n      },\n      \"Rating\": 4.0,\n      \"Description\": \"Vị trí trung tâm phố cổ, thuận tiện đi lại. Phòng nghỉ sạch sẽ, cơ bản, phù hợp với ngân sách hạn chế.\"\n    },\n    {\n      \"HotelName\": \"Little Hanoi Diamond Hotel\",\n      \"Address\": \"11 Bát Đàn, Hàng Bồ, Hoàn Kiếm, Hà Nội\",\n      \"Price\": \"Khoảng 600.000 - 900.000 VND/đêm\",\n      \"ImageUrl\": \"https://cf.bstatic.com/xdata/images/hotel/max1024x768/147063631.jpg?k=7e99a35a4e08a68904074b0c4d11b86c0419d89d6f9a444751a403729e023bb4&o=&hp=1\",\n      \"Coordinates\": {\n        \"latitude\": 21.0344,\n        \"longitude\": 105.8478\n      },\n      \"Rating\": 4.2,\n      \"Description\": \"Khách sạn nhỏ xinh nằm trong khu phố cổ, gần các điểm ăn uống và tham quan. Nhân viên thân thiện.\"\n    },\n    {\n      \"HotelName\": \"Cocoon Inn Hotel\",\n      \"Address\": \"116 Hàng Buồm, Hoàn Kiếm, Hà Nội\",\n      \"Price\": \"Khoảng 450.000 - 750.000 VND/đêm (có cả phòng dorm và phòng riêng)\",\n      \"ImageUrl\": \"https://cf.bstatic.com/xdata/images/hotel/max1024x768/207741631.jpg?k=6b4c306a450523dfa5e0b16e59772c88a9a6a9226686d408b1913f574630b45f&o=&hp=1\",\n      \"Coordinates\": {\n        \"latitude\": 21.0366,\n        \"longitude\": 105.8511\n      },\n      \"Rating\": 4.5,\n      \"Description\": \"Một lựa chọn phổ biến cho du khách ba lô và cặp đôi muốn tiết kiệm. Có không gian chung sôi động và phòng riêng sạch sẽ.\"\n    },\n    {\n      \"HotelName\": \"Hanoi Graceful Hotel\",\n      \"Address\": \"21 Hàng Phèn, Hàng Bồ, Hoàn Kiếm, Hà Nội\",\n      \"Price\": \"Khoảng 550.000 - 850.000 VND/đêm\",\n      \"ImageUrl\": \"https://pix8.agoda.net/hotelImages/287/287844/287844_16081717100045610667.jpg?ce=0&s=1024x\",\n      \"Coordinates\": {\n        \"latitude\": 21.0352,\n        \"longitude\": 105.8471\n      },\n      \"Rating\": 4.1,\n      \"Description\": \"Nằm trong ngõ nhỏ yên tĩnh hơn của phố cổ, phòng ốc khá tốt so với mức giá. Dịch vụ ổn.\"\n    }\n  ],\n  \"dailyItinerary\": [\n    {\n      \"day\": 1,\n      \"theme\": \"Khám phá Trái tim Hà Nội - Phố Cổ & Hồ Gươm\",\n      \"schedule\": [\n        {\n          \"Time\": \"08:00 - 09:00\",\n          \"PlaceName\": \"Nhận phòng khách sạn\",\n          \"Details\": \"Đến Hà Nội, di chuyển về khách sạn đã đặt trước. Gửi đồ nếu chưa đến giờ nhận phòng và bắt đầu hành trình.\",\n          \"ImageUrl\": \"https://example.com/placeholder_checkin.jpg\", // Placeholder\n          \"Coordinates\": {\n            \"latitude\": 21.0333, // Tọa độ trung tâm khu phố cổ (ước lượng)\n            \"longitude\": 105.8500\n          },\n          \"TicketPrice\": \"Miễn phí\",\n          \"Rating\": null,\n          \"EstimatedDuration\": \"1 giờ\"\n        },\n        {\n          \"Time\": \"09:00 - 11:00\",\n          \"PlaceName\": \"Hồ Hoàn Kiếm (Hồ Gươm) & Đền Ngọc Sơn\",\n          \"Details\": \"Đi bộ quanh hồ, tận hưởng không khí trong lành buổi sáng. Ghé thăm Đền Ngọc Sơn trên đảo Ngọc qua cầu Thê Húc. Địa điểm lãng mạn, biểu tượng của Hà Nội.\",\n          \"ImageUrl\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/e/ed/Ngoc_Son_Temple_gates%2C_Hanoi%2C_Vietnam.jpg/1280px-Ngoc_Son_Temple_gates%2C_Hanoi%2C_Vietnam.jpg\",\n          \"Coordinates\": {\n            \"latitude\": 21.0288,\n            \"longitude\": 105.8522\n          },\n          \"TicketPrice\": \"Vé vào Đền Ngọc Sơn: ~30.000 VND/người. Đi dạo quanh hồ miễn phí.\",\n          \"Rating\": 4.5,\n          \"EstimatedDuration\": \"2 giờ\"\n        },\n        {\n          \"Time\": \"11:00 - 12:30\",\n          \"PlaceName\": \"Nhà thờ Lớn Hà Nội\",\n          \"Details\": \"Tham quan kiến trúc Gothic cổ kính của Nhà thờ Thánh Giuse. Chụp ảnh kỷ niệm. Có thể ghé các quán cafe 'view nhà thờ' gần đó.\",\n          \"ImageUrl\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/8/8d/St._Joseph%27s_Cathedral%2C_Hanoi%2C_Vietnam.jpg/1024px-St._Joseph%27s_Cathedral%2C_Hanoi%2C_Vietnam.jpg\",\n          \"Coordinates\": {\n            \"latitude\": 21.0287,\n            \"longitude\": 105.8488\n          },\n          \"TicketPrice\": \"Miễn phí (vào tham quan bên ngoài và sân)\",\n          \"Rating\": 4.4,\n          \"EstimatedDuration\": \"1.5 giờ (bao gồm cả ngồi cafe nếu muốn)\"\n        },\n        {\n          \"Time\": \"12:30 - 14:00\",\n          \"PlaceName\": \"Ăn trưa Phố Cổ\",\n          \"Details\": \"Thưởng thức đặc sản Hà Nội giá bình dân như Bún Chả (Hàng Mành/Ngõ Huyện), Phở (Bát Đàn/Lý Quốc Sư), Bún Đậu Mắm Tôm (Ngõ Phất Lộc).\",\n          \"ImageUrl\": \"https://statics.vinwonders.com/styles/1920x1080/public/2022-04/bun-cha-ha-noi-dac-san-mien-bac-thom-ngon-nuc-tieng-01.jpg.webp?itok=7_hPqD7c\",\n          \"Coordinates\": {\n            \"latitude\": 21.0333, // Tọa độ trung tâm khu phố cổ (ước lượng)\n            \"longitude\": 105.8500\n          },\n          \"TicketPrice\": \"Khoảng 50.000 - 100.000 VND/người\",\n          \"Rating\": 4.6,\n          \"EstimatedDuration\": \"1.5 giờ\"\n        },\n        {\n          \"Time\": \"14:00 - 17:00\",\n          \"PlaceName\": \"Dạo chơi Phố Cổ\",\n          \"Details\": \"Đi bộ khám phá các con phố nghề đặc trưng: Hàng Bạc, Hàng Mã, Hàng Gai, Hàng Đường... Ngắm kiến trúc nhà cổ, cuộc sống thường nhật và mua sắm quà lưu niệm nhỏ.\",\n          \"ImageUrl\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/9/98/Old_Quarter%2C_Hanoi_%285047166910%29.jpg/1280px-Old_Quarter%2C_Hanoi_%285047166910%29.jpg\",\n          \"Coordinates\": {\n            \"latitude\": 21.0350,\n            \"longitude\": 105.8490\n          },\n          \"TicketPrice\": \"Miễn phí\",\n          \"Rating\": 4.3,\n          \"EstimatedDuration\": \"3 giờ\"\n        },\n        {\n          \"Time\": \"17:30 - 18:30\",\n          \"PlaceName\": \"Xem Múa Rối Nước (Nhà hát Múa rối Thăng Long)\",\n          \"Details\": \"Thưởng thức loại hình nghệ thuật truyền thống độc đáo của Việt Nam. Nên đặt vé trước.\",\n          \"ImageUrl\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/Thang_Long_Water_Puppet_Theatre_%285047167912%29.jpg/1280px-Thang_Long_Water_Puppet_Theatre_%285047167912%29.jpg\",\n          \"Coordinates\": {\n            \"latitude\": 21.0307,\n            \"longitude\": 105.8527\n          },\n          \"TicketPrice\": \"Khoảng 100.000 - 200.000 VND/người (tùy vị trí)\",\n          \"Rating\": 4.2,\n          \"EstimatedDuration\": \"1 giờ\"\n        },\n        {\n          \"Time\": \"19:00 - 21:00\",\n          \"PlaceName\": \"Ăn tối và dạo chợ đêm Đồng Xuân (nếu vào cuối tuần)\",\n          \"Details\": \"Ăn tối với các món ăn đường phố đa dạng quanh khu vực chợ Đồng Xuân hoặc phố Hàng Buồm. Nếu đi vào tối Thứ 6, 7, CN, có thể kết hợp dạo chơi Chợ đêm Phố cổ (Hàng Đào - Đồng Xuân).\",\n          \"ImageUrl\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/f/fc/%C4%90%E1%BB%93ng_Xu%C3%A2n_Market_%285047167400%29.jpg/1280px-%C4%90%E1%BB%93ng_Xu%C3%A2n_Market_%285047167400%29.jpg\",\n          \"Coordinates\": {\n            \"latitude\": 21.0380,\n            \"longitude\": 105.8485\n          },\n          \"TicketPrice\": \"Ăn uống tùy chọn, khoảng 70.000 - 150.000 VND/người. Dạo chợ miễn phí.\",\n          \"Rating\": 4.0,\n          \"EstimatedDuration\": \"2 giờ\"\n        }\n      ]\n    },\n    {\n      \"day\": 2,\n      \"theme\": \"Dấu ấn Lịch sử & Văn hóa\",\n      \"schedule\": [\n        {\n          \"Time\": \"08:30 - 10:30\",\n          \"PlaceName\": \"Văn Miếu - Quốc Tử Giám\",\n          \"Details\": \"Trường đại học đầu tiên của Việt Nam. Không gian cổ kính, trang nghiêm với kiến trúc đẹp, hồ nước, vườn cây xanh mát. Nơi cầu may mắn trong học tập, thi cử.\",\n          \"ImageUrl\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/8/8d/Van_Mieu_Ha_Noi_19.JPG/1280px-Van_Mieu_Ha_Noi_19.JPG\",\n          \"Coordinates\": {\n            \"latitude\": 21.0278,\n            \"longitude\": 105.8357\n          },\n          \"TicketPrice\": \"~30.000 VND/người\",\n          \"Rating\": 4.6,\n          \"EstimatedDuration\": \"2 giờ\"\n        },\n        {\n          \"Time\": \"10:45 - 12:15\",\n          \"PlaceName\": \"Di tích Nhà tù Hỏa Lò\",\n          \"Details\": \"Tìm hiểu về lịch sử đấu tranh cách mạng của Việt Nam qua các hiện vật, câu chuyện tại 'địa ngục trần gian' giữa lòng Hà Nội. Lưu ý: có thể không phù hợp với người yếu tim.\",\n          \"ImageUrl\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/e/e7/Maison_Centrale_Gate_2018.jpg/1280px-Maison_Centrale_Gate_2018.jpg\",\n          \"Coordinates\": {\n            \"latitude\": 21.0249,\n            \"longitude\": 105.8460\n          },\n          \"TicketPrice\": \"~30.000 VND/người\",\n          \"Rating\": 4.5,\n          \"EstimatedDuration\": \"1.5 giờ\"\n        },\n        {\n          \"Time\": \"12:30 - 13:45\",\n          \"PlaceName\": \"Ăn trưa gần khu vực\",\n          \"Details\": \"Thưởng thức các món ăn địa phương gần khu vực Nhà tù Hỏa Lò hoặc quay lại khu vực gần Văn Miếu.\",\n          \"ImageUrl\": \"https://example.com/placeholder_lunch2.jpg\", // Placeholder\n          \"Coordinates\": {\n            \"latitude\": 21.0260, // Tọa độ ước lượng khu vực lân cận\n            \"longitude\": 105.8400\n          },\n          \"TicketPrice\": \"Khoảng 50.000 - 100.000 VND/người\",\n          \"Rating\": 4.0,\n          \"EstimatedDuration\": \"1.25 giờ\"\n        },\n        {\n          \"Time\": \"14:00 - 15:30\",\n          \"PlaceName\": \"Phố đường tàu (Lê Duẩn / Phùng Hưng)\",\n          \"Details\": \"Trải nghiệm độc đáo khi quan sát tàu hỏa chạy sát qua khu dân cư. Có nhiều quán cafe nhỏ xinh dọc đường ray. Lưu ý kiểm tra lịch tàu chạy và đảm bảo an toàn.\",\n          \"ImageUrl\": \"https://upload.wikimedia.org/wikipedia/commons/d/d8/Hanoi_Train_Street_2018.jpg\",\n          \"Coordinates\": {\n            \"latitude\": 21.0305, // Đoạn Phùng Hưng (ước lượng)\n            \"longitude\": 105.8445\n          },\n          \"TicketPrice\": \"Miễn phí (có thể tốn tiền cafe nếu ngồi quán)\",\n          \"Rating\": 4.1,\n          \"EstimatedDuration\": \"1.5 giờ (bao gồm chờ tàu nếu muốn)\"\n        },\n        {\n          \"Time\": \"15:45 - 17:00\",\n          \"PlaceName\": \"Thư giãn tại quán Cafe trứng Giảng\",\n          \"Details\": \"Thưởng thức món cafe trứng độc đáo, đặc sản của Hà Nội tại quán gốc lâu đời. Không gian nhỏ, ấm cúng.\",\n          \"ImageUrl\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/e/e9/C%C3%A0_ph%C3%AA_tr%E1%BB%A9ng_-_Egg_Coffee_%2815481946928%29.jpg/1024px-C%C3%A0_ph%C3%AA_tr%E1%BB%A9ng_-_Egg_Coffee_%2815481946928%29.jpg\",\n          \"Coordinates\": {\n            \"latitude\": 21.0313, // Cafe Giảng ngõ 39 Nguyễn Hữu Huân\n            \"longitude\": 105.8536\n          },\n          \"TicketPrice\": \"Khoảng 30.000 - 50.000 VND/cốc\",\n          \"Rating\": 4.3,\n          \"EstimatedDuration\": \"1.25 giờ\"\n        },\n        {\n          \"Time\": \"17:30 - 19:00\",\n          \"PlaceName\": \"Hoàng thành Thăng Long (Tham quan bên ngoài hoặc vào trong nếu còn thời gian)\",\n          \"Details\": \"Di sản Văn hóa Thế giới. Nếu không đủ thời gian vào trong, có thể đi dạo, chụp ảnh khu vực cổng Đoan Môn, Cột cờ Hà Nội từ bên ngoài.\",\n          \"ImageUrl\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a3/Doan_Mon_Gate%2C_Imperial_Citadel_of_Thang_Long%2C_Hanoi.jpg/1280px-Doan_Mon_Gate%2C_Imperial_Citadel_of_Thang_Long%2C_Hanoi.jpg\",\n          \"Coordinates\": {\n            \"latitude\": 21.0357,\n            \"longitude\": 105.8400\n          },\n          \"TicketPrice\": \"Vé vào cổng: ~30.000 VND/người. Tham quan bên ngoài miễn phí.\",\n          \"Rating\": 4.4,\n          \"EstimatedDuration\": \"1.5 giờ\"\n        },\n        {\n          \"Time\": \"19:30 onwards\",\n          \"PlaceName\": \"Ăn tối và kết thúc chuyến đi\",\n          \"Details\": \"Chọn một quán ăn yêu thích để thưởng thức bữa tối cuối cùng tại Hà Nội. Có thể là lẩu, đồ nướng hoặc các món đặc sản khác. Sau đó quay về khách sạn hoặc ra sân bay/nhà ga.\",\n          \"ImageUrl\": \"https://example.com/placeholder_dinner_final.jpg\", // Placeholder\n          \"Coordinates\": {\n            \"latitude\": 21.0333, // Tọa độ trung tâm khu phố cổ (ước lượng)\n            \"longitude\": 105.8500\n          },\n          \"TicketPrice\": \"Tùy chọn, khoảng 100.000 - 200.000 VND/người\",\n          \"Rating\": null,\n          \"EstimatedDuration\": \"2+ giờ\"\n        }\n      ]\n    }\n  ],\n  \"notes\": [\n    \"Giá khách sạn và vé tham quan chỉ là ước tính, có thể thay đổi tùy thời điểm và chính sách.\",\n    \"Lịch trình có thể điều chỉnh linh hoạt tùy theo sở thích và tốc độ di chuyển của cặp đôi.\",\n    \"Nên sử dụng phương tiện công cộng (xe buýt), xe ôm công nghệ (Grab/Gojek) hoặc đi bộ để tiết kiệm chi phí di chuyển.\",\n    \"Ẩm thực đường phố là lựa chọn tuyệt vời để tiết kiệm chi phí và trải nghiệm văn hóa địa phương.\",\n    \"Luôn hỏi giá trước khi mua hàng hoặc sử dụng dịch vụ.\",\n    \"Kiểm tra giờ mở cửa/đóng cửa của các địa điểm tham quan, đặc biệt là các di tích lịch sử, bảo tàng.\"\n  ]\n}\n```"},

                ]
            }
        ]
    })



